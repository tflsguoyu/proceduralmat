# A Bayesian Inference Framework for Procedural Material Parameter Estimation

[Yu Guo](https://tflsguoyu.github.io/), [Miloš Hašan](http://miloshasan.net/), [Lingqi Yan](https://sites.cs.ucsb.edu/~lingqi/), [Shuang Zhao](https://shuangz.com/). 
In Computer Graphics Forum (Pacific Graphics 2020). 

<img src="https://github.com/tflsguoyu/proceduralmat_suppl/blob/master/github/teaser.jpg" width="750px">

[[Paper](https://github.com/tflsguoyu/proceduralmat_paper/blob/master/proceduralmat.pdf)]
[[Code](https://github.com/tflsguoyu/proceduralmat/)]
[[Supplemental Materials](https://tflsguoyu.github.io/proceduralmat_suppl/)]
[[Poster](https://github.com/tflsguoyu/proceduralmat_poster/blob/master/proceduralmat_poster.pdf)]
[[Presentation on Pacific Graphics 2020](https://youtu.be/fQPBqHKJmWQ) ([Slides](https://www.dropbox.com/s/aidtlb5v8b1rhtk/proceduralmat.pptx?dl=0))]

## Overview
In this repository, it provides procedural model generation demo code, sampling demo code, and the code to generate the results in this paper. 

## Install (Tested on Windows 10 x64)  
  - Install Nvidia driver 
  - Install Cuda Toolkit 10.2
  - Install Anaconda and create env (python 3.8)
  - Install Pytorch 1.4 (conda install pytorch torchvision cudatoolkit=10.1 -c pytorch) 
  - Install libs
  - pip install matplotlib imageio scipy openexr (sudo apt install libopenexr-dev)
   
## Examples in paper

## Notes
 - 09/19/2022: This is an uncleaned version, only the code in `procedural_model_test` are available to use.  
 - 09/19/2022: TODO: Clean up codes.
 - Welcome to report bugs and leave comments (Yu Guo: tflsguoyu@gmail.com)
